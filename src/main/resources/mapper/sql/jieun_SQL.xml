<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="jieun">

<!-- 단골 가맹점 리스트 -->
	<select id="selectMyBusinessList" parameterType="hashmap" resultType="hashmap">
        <![CDATA[
        	SELECT 
			    S.userID,
			    B.businessName,
			    B.businessAddress,
			    COUNT(IF(S.couponNum IS NULL, 1, NULL)) stampCount,
			    COUNT(*) totalStampCount
			FROM
			    stamplist S,
			    business B
			WHERE
			    S.businessId = B.businessId
			AND
				S.userID = #{USERID}
			GROUP BY S.businessId    			
        ]]>
    </select>
    
    <select id="selectCheckMembership" parameterType="hashmap" resultType="hashmap">
        <![CDATA[
        	SELECT
     			*
    		FROM
    			MEMBERSHIP		
        ]]>
    </select>
    
    <insert id="insertMyBusiness" parameterType="hashmap">
    	<![CDATA[
    		INSERT
    			INTO MEMBERSHIP
    		VALUES
    			( #{USERID} , #{BUSINESSID} )
    	]]>
    </insert>
    
    <delete id="deleteMyBusiness" parameterType="hashmap">
    	<![CDATA[
    		DELETE FROM
    			MEMBERSHIP
    		WHERE
    			userID = #{USERID}
			AND
				businessID = #{BUSINESSID}
    	]]>
    </delete>
</mapper>

